<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<script src="js/header.js"></script>
<script src="js/util.js"></script>
<script>

function loadShiftType(){
	var res= getJson("/admin/loadShiftType");
	var color = ["'success'","'warning'","'danger'"];
	var cont = "";
	for(i in res){
		cont = cont + "<tr class=" + color[i%3] + ">";
		
		for(j in res[i]){
			if(j!="score" && j!="id" && j!="used" && res[i].used==true){
				cont = cont + "<td>" +res[i][j] + "</td>";
			}
		}
		cont = cont + "</td></tr>"
	}
	$("#shiftType").html(cont);
}

function showHead(){
	var date = new Date();
	var day = date.getDay();
	if(day==0){
		day = 7;
	}
	date.setDate(date.getDate()-day);
	for(i=0;i<14;i++){
		date.setDate(date.getDate()+1);
		var str = showDay(date.getDay()) + "(" + (date.getMonth()+1) + "/" + date.getDate() +")";
		$(".day").eq(i).text(str);
		$(".dayShift").eq(i).text(str);
	}
}

function getRoster(week){
	var url = "/getRoster/"+week;
	return getJson(url);
}

function getRosterByLevel(week,level){
	var url = "/getRoster/"+week + "/" + level;
	return getJson(url);
}

function fillRoster(){
	var levelName = ["N0:Nurse","N1:Nurse Practitioner","N2:Nurse-in-charge","N3:Associate Professor of Nursing","N4:Professor of Nursing"];
	var cont = "";
	var shiftRoster =new Object();
	for(var lv=1;lv<=5;lv++){
		var ros1 = getRosterByLevel(1,lv);
		cont = cont + "<tr><td colspan='9' class='info'><b>"+levelName[lv-1]+"</b></td></tr>"

		for(i in ros1){
			//get shift roster
			if(shiftRoster[ros1[i].monShift] == undefined){
				shiftRoster[ros1[i].monShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].monShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].monShift][j][k]="";
					}
				}
				
				shiftRoster[ros1[i].monShift][0][lv-1] = "<div>"+ros1[i].nickName + "</div>";
				
			}else{
				shiftRoster[ros1[i].monShift][0][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//tue
			if(shiftRoster[ros1[i].tueShift] == undefined){
				shiftRoster[ros1[i].tueShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].tueShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].tueShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].tueShift][1][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].tueShift][1][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//wed
			if(shiftRoster[ros1[i].wedShift] == undefined){
				shiftRoster[ros1[i].wedShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].wedShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].wedShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].wedShift][2][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].wedShift][2][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//thu
			if(shiftRoster[ros1[i].thuShift] == undefined){
				shiftRoster[ros1[i].thuShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].thuShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].thuShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].thuShift][3][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].thuShift][3][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//fri
			if(shiftRoster[ros1[i].friShift] == undefined){
				shiftRoster[ros1[i].friShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].friShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].friShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].friShift][4][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].friShift][4][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//sat
			if(shiftRoster[ros1[i].satShift] == undefined){
				shiftRoster[ros1[i].satShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].satShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].satShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].satShift][5][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].satShift][5][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			//sun
			if(shiftRoster[ros1[i].sunShift] == undefined){
				shiftRoster[ros1[i].sunShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros1[i].sunShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros1[i].sunShift][j][k]="";
					}
				}
				shiftRoster[ros1[i].sunShift][6][lv-1] = "<div>"+ros1[i].nickName + "</div>";
			}else{
				shiftRoster[ros1[i].sunShift][6][lv-1] += "<div>"+ros1[i].nickName + "</div>";
			}
			
			
			//fill roster
			cont = cont + "<tr>";
			cont = cont + "<th>" +ros1[i].nickName + "</th>";
			for (j in ros1[i]){
				if(j!="monId" && j!="tueId" && j!="wedId" && j!="thuId"
					&& j!="friId" && j!="satId" && j!="sunId" 
					&& j!="userId" && j!="userName" && j!="nickName"  ){
					cont = cont + "<th>" +ros1[i][j] + "</th>";
				}
			}
			cont = cont + "</tr>";

		}
	}
	$("#thisTbody").html(cont);
	
	var contShift = "";
	var color = ["'success'","'warning'","'danger'"];
	var colorIdx = 0;
	for(var shift in shiftRoster){
		contShift = contShift + "<tr><td rowspan='10' style='width:15%' class=" +color[colorIdx%3] + "><b>" + shift +"</b></td>";
		colorIdx += 1;
		for(var idxL=0;idxL<5;idxL++){
			if(idxL!=0){
				contShift += "<tr>"
			}
			contShift = contShift + "<td class='info' colspan='7'><b>" + levelName[idxL] + "</b></td></tr><tr>";
			for(var idxD=0;idxD<7;idxD++){
				contShift = contShift + "<td>" + shiftRoster[shift][idxD][idxL] + "</td>";
			}
			contShift += "</tr>"
		}
	}
	 
	$("#thisTbodyShift").html(contShift);
	
	
	//next 
	cont = "";
	var shiftRoster =new Object();
	for(var lv=1;lv<=5;lv++){
		var ros2 = getRosterByLevel(2,lv);
		cont = cont + "<tr><td colspan='9' class='info'><b>"+levelName[lv-1]+"</b></td></tr>"

		for(i in ros2){
			//get shift roster
			if(shiftRoster[ros2[i].monShift] == undefined){
				shiftRoster[ros2[i].monShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].monShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].monShift][j][k]="";
					}
				}
				
				shiftRoster[ros2[i].monShift][0][lv-1] = "<div>"+ros2[i].nickName + "</div>";
				
			}else{
				shiftRoster[ros2[i].monShift][0][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//tue
			if(shiftRoster[ros2[i].tueShift] == undefined){
				shiftRoster[ros2[i].tueShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].tueShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].tueShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].tueShift][1][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].tueShift][1][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//wed
			if(shiftRoster[ros2[i].wedShift] == undefined){
				shiftRoster[ros2[i].wedShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].wedShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].wedShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].wedShift][2][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].wedShift][2][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//thu
			if(shiftRoster[ros2[i].thuShift] == undefined){
				shiftRoster[ros2[i].thuShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].thuShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].thuShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].thuShift][3][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].thuShift][3][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//fri
			if(shiftRoster[ros2[i].friShift] == undefined){
				shiftRoster[ros2[i].friShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].friShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].friShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].friShift][4][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].friShift][4][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//sat
			if(shiftRoster[ros2[i].satShift] == undefined){
				shiftRoster[ros2[i].satShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].satShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].satShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].satShift][5][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].satShift][5][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			//sun
			if(shiftRoster[ros2[i].sunShift] == undefined){
				shiftRoster[ros2[i].sunShift] = new Array();
				for(var j=0;j<7;j++){
					shiftRoster[ros2[i].sunShift][j] = new Array();
					for(var k=0;k<5;k++){
						shiftRoster[ros2[i].sunShift][j][k]="";
					}
				}
				shiftRoster[ros2[i].sunShift][6][lv-1] = "<div>"+ros2[i].nickName + "</div>";
			}else{
				shiftRoster[ros2[i].sunShift][6][lv-1] += "<div>"+ros2[i].nickName + "</div>";
			}
			
			
			//fill roster
			cont = cont + "<tr>";
			cont = cont + "<th>" +ros2[i].nickName + "</th>";
			for (j in ros2[i]){
				if(j!="monId" && j!="tueId" && j!="wedId" && j!="thuId"
					&& j!="friId" && j!="satId" && j!="sunId" 
					&& j!="userId" && j!="userName" && j!="nickName"  ){
					cont = cont + "<th>" +ros2[i][j] + "</th>";
				}
			}
			cont = cont + "</tr>";

		}
	}
	$("#nextTbody").html(cont);
	
	contShift = "";
	colorIdx = 0;
	for(var shift in shiftRoster){
		contShift = contShift + "<tr><td rowspan='10' style='width:15%' class=" +color[colorIdx%3] + "><b>" + shift +"</b></td>";
		colorIdx += 1;
		for(var idxL=0;idxL<5;idxL++){
			if(idxL!=0){
				contShift += "<tr>"
			}
			contShift = contShift + "<td class='info' colspan='7'><b>" + levelName[idxL] + "</b></td></tr><tr>";
			for(var idxD=0;idxD<7;idxD++){
				contShift = contShift + "<td>" + shiftRoster[shift][idxD][idxL] + "</td>";
			}
			contShift += "</tr>"
		}
	}
	$("#nextTbodyShift").html(contShift);
}



function thisWeek(){
	$("#tbNextWeek").hide();
	$("#tbThisWeek").show();
	$('#tbThisShift').hide();
	$('#tbThisNurse').show();
	$("#thisBtn").attr("class","active");
	$("#nextBtn").attr("class","");
}

function nextWeek(){
	$("#tbThisWeek").hide();
	$("#tbNextWeek").show();
	$('#tbNextShift').hide();
	$('#tbNextNurse').show();
	$("#thisBtn").attr("class","");
	$("#nextBtn").attr("class","active");
}

function init(){
	loadShiftType();
	showHead();
	fillRoster();
	thisWeek();
}
</script>
<title>NurseHub</title>
</head>
<body>

 <nav class="navbar navbar-default" role="navigation">
 	<div class="container-fluid">
 	<div class="navbar-header">
        <a class="navbar-brand" href="#">NurseHub</a>
    </div>
    <div>
        <ul class="nav navbar-nav">
            <li id="thisBtn" class="active"><a href="#" onclick="thisWeek()" >ThisWeek</a></li>
            <li id="nextBtn"><a href="#" onclick="nextWeek()">NextWeek</a></li>
        </ul>
    </div>
    <div style="text-align:right">
    	<p> </p>
    	<a href="login.html">login</a>
    </div>
	</div>
 </nav>

<table class="table table-striped">
	<caption>Shift Type</caption>
<thead>
	<tr>
		<th>ShiftName</th>
		<th>BeginTime</th>
		<th>EndTime</th>
		<th>Total(h)</th>
	</tr>
	</thead>
	<tbody id="shiftType" >
	</tbody>
</table>
 
 <div id ="tbThisWeek">
 <ol class="breadcrumb">
    <span>ROSTER THIS WEEK:</span>
    
    <li><a href="#" onclick="$('#tbThisShift').hide();$('#tbThisNurse').show();">byNurse</a></li>
    <li><a href="#" onclick="$('#tbThisShift').show();$('#tbThisNurse').hide();">byShift</a></li>
</ol>


 <table  id="tbThisNurse" class="table table-striped">
  <caption>ROSTER THIS WEEK</caption>
  <thead>
    <tr>
      <th>UserName</th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th>Hours</th>
    </tr>
  </thead>
  <tbody id="thisTbody"></tbody>
</table>

 <table  id="tbThisShift" class="table table-striped">
  <caption>ROSTER THIS WEEK</caption>
  <thead>
    <tr>
      <th>Shift</th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
    </tr>
  </thead>
  <tbody id="thisTbodyShift"></tbody>
</table>

</div>




<div id="tbNextWeek">
<ol class="breadcrumb">
    <span>ROSTER NEXT WEEK:</span>
    <li><a href="#" onclick="$('#tbNextShift').hide();$('#tbNextNurse').show();">byNurse</a></li>
    <li><a href="#" onclick="$('#tbNextShift').show();$('#tbNextNurse').hide();">byShift</a></li>
</ol>
<table id="tbNextNurse"  class="table table-striped">
  <caption>ROSTER NEXT WEEK</caption>
  <thead>
    <tr>
      <th>UserName</th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th class="day"></th>
      <th>Hours</th>
    </tr>
  </thead>
  <tbody id="nextTbody"> </tbody>
</table>

<table  id="tbNextShift" class="table table-striped">
  <caption>ROSTER NEXT WEEK</caption>
  <thead>
    <tr>
      <th>Shift</th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
      <th class="dayShift"></th>
    </tr>
  </thead>
  <tbody id="nextTbodyShift"></tbody>
</table>
</div>

<script>
init();
$("td:not(.info),th").addClass("text-center");
$(".info").css("text-align:left");
</script>



</body>
</html>